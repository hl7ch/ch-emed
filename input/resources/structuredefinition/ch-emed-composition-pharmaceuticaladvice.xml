<StructureDefinition xmlns="http://hl7.org/fhir">
   <id value="ch-emed-composition-pharmaceuticaladvice"/>
   <url value="http://fhir.ch/ig/ch-emed/StructureDefinition/ch-emed-composition-pharmaceuticaladvice"/>
   <version value="0.1.0"/>
   <name value="CHEMEDCompositionPharmaceuticalAdvice"/>
   <title value="CH EMED Pharmaceutical Advice Composition"/>
   <status value="active"/>
   <experimental value="false"/>
   <description value="Definition of the composition for the pharmaceutical advice document"/>
   <kind value="resource"/>
   <abstract value="false"/>
   <type value="Composition"/>
   <baseDefinition value="http://fhir.ch/ig/ch-core/StructureDefinition/ch-core-composition-epr"/>
   <derivation value="constraint"/>
   <differential>
      <element id="Composition">
         <path value="Composition"/>
         <short value="CH EMED Pharmaceutical Advice Composition"/>
      </element>
      <element id="Composition.language">
         <path value="Composition.language"/>
         <short value="Language of the document"/>
      </element>
      <element id="Composition.identifier.system">
         <path value="Composition.identifier.system"/>
         <min value="1"/>
      </element>
      <element id="Composition.identifier.value">
         <path value="Composition.identifier.value"/>
         <min value="1"/>
         <example>
            <label value="CH EMED"/>
            <valueString value="urn:uuid:daa8cd41-34a1-4a9c-9a6d-cd3f850142e9"/>
         </example>
      </element>
      <element id="Composition.status">
         <path value="Composition.status"/>
         <fixedCode value="final"/>
      </element>
      <element id="Composition.type">
         <path value="Composition.type"/>
         <short value="Record artifact"/>
         <patternCodeableConcept>
            <coding>
               <system value="http://snomed.info/sct"/>
               <code value="419891008"/>
            </coding>
         </patternCodeableConcept>
      </element>
      <element id="Composition.subject">
         <path value="Composition.subject"/>
         <short value="A patient for whom this document instance was created"/>
      </element>
      <element id="Composition.date">
         <path value="Composition.date"/>
         <short value="The document's creation date and time"/>
      </element>
      <element id="Composition.author">
         <path value="Composition.author"/>
         <short value="The author of the document (person)"/>
         <type>
            <code value="Reference"/>
            <targetProfile value="http://fhir.ch/ig/ch-emed/StructureDefinition/ch-emed-practitionerrole"/>
            <!--<targetProfile value="http://hl7.org/fhir/StructureDefinition/Device"/>-->
            <targetProfile value="http://fhir.ch/ig/ch-core/StructureDefinition/ch-core-patient-epr"/>
            <targetProfile value="http://hl7.org/fhir/StructureDefinition/RelatedPerson"/>
         </type>
      </element>
      <element id="Composition.title">
         <path value="Composition.title"/>
         <short value="'Kommentar zur Medikation' in german or 'Commentaire relatif à la médication' in french or 'Commento sulla terapia farmacologica' in italian or 'Pharmaceutical Advice' in english
                        or titles in other languages are also allowed"/>
      </element>
      <element id="Composition.confidentiality.extension">
         <path value="Composition.confidentiality.extension"/>
         <slicing>
            <discriminator>
               <type value="value"/>
               <path value="url"/>
            </discriminator>
            <rules value="open"/>
         </slicing>
      </element>
      <element id="Composition.confidentiality.extension:confidentialityCode">
         <path value="Composition.confidentiality.extension"/>
         <sliceName value="confidentialityCode"/>
         <short value="Swiss realm of confidentiality code according to the Swiss EPR regulation"/>
      </element>
      <element id="Composition.attester">
         <path value="Composition.attester"/>
         <slicing>
            <discriminator>
               <type value="value" />
               <path value="mode" />
            </discriminator>
            <rules value="open" />
         </slicing>
         <short value="The authenticator of the document (person)"/>
      </element>
      <element id="Composition.attester:legalAuthenticator">
         <path value="Composition.attester"/>
         <sliceName value="legalAuthenticator"/>
         <short value="The legal authenticator of the document (person)"/>
      </element>
      <element id="Composition.attester.time:legalAuthenticator">
         <path value="Composition.attester.time"/>
         <short value="Timestamp of the signature"/>
      </element>
      <element id="Composition.attester.party:legalAuthenticator">
         <path value="Composition.attester.party"/>
         <short value="Who attested the composition"/>
      </element>
      <element id="Composition.custodian">
         <path value="Composition.custodian"/>
         <short value="The organization in whose name the document has been created"/>
         <min value="1"/>
      </element>
      <element id="Composition.section">
         <path value="Composition.section"/>
         <min value="1"/>
         <slicing>
            <discriminator>
               <type value="pattern"/>
               <path value="code"/>
            </discriminator>
            <ordered value="false"/>
            <rules value="open"/>
         </slicing>
      </element>
      <!-- Section Pharmaceutical Advice (Observation) -->
      <element id="Composition.section:pharmaceuticalAdvice">
         <path value="Composition.section"/>
         <sliceName value="pharmaceuticalAdvice"/>
         <short value="Pharmaceutical advice"/>
         <min value="1"/>
         <max value="1"/>
      </element>
      <element id="Composition.section:pharmaceuticalAdvice.title">
         <path value="Composition.section.title"/>
         <short value="'Hinweise zur Medikation' in german or 'Conseils sur les médicaments' in french or 'Consigli sui medicamenti' in italian or 'Pharmaceutical Advice' in english
                        or titles in other languages are also allowed"/>
         <min value="1"/>
         <max value="1"/>
      </element>
      <element id="Composition.section:pharmaceuticalAdvice.code">
         <path value="Composition.section.code"/>
         <min value="1"/>
         <patternCodeableConcept>
            <coding>
               <system value="http://loinc.org"/>
               <code value="61357-0"/>
               <display value="Medication pharmaceutical advice.brief"/>
            </coding>
         </patternCodeableConcept>
      </element>
      <!-- Author of the section -->
      <element id="Composition.section:pharmaceuticalAdvice.author">
         <path value="Composition.section.author"/>
         <short value="The author of the medical decision (person) if different from the author of the document (Composition.author), see also 'Guidance - Different Authors'"/>
         <type>
            <code value="Reference"/>
            <targetProfile value="http://fhir.ch/ig/ch-emed/StructureDefinition/ch-emed-practitionerrole"/>
            <targetProfile value="http://fhir.ch/ig/ch-core/StructureDefinition/ch-core-patient-epr"/>
            <targetProfile value="http://hl7.org/fhir/StructureDefinition/RelatedPerson"/>
         </type>
      </element>
      <element id="Composition.section:pharmaceuticalAdvice.author.reference">
         <path value="Composition.section.author.reference"/>
         <min value="1"/>
      </element>
      <element id="Composition.section:pharmaceuticalAdvice.text">
         <path value="Composition.section.text"/>
         <short value="Human readable text of this section"/>
         <min value="1"/>
         <max value="1"/>
      </element>
      <element id="Composition.section:pharmaceuticalAdvice.entry">
         <path value="Composition.section.entry"/>
         <short value="Observation"/>
         <min value="1"/>
         <max value="1"/>
         <type>
            <code value="Reference"/>
            <targetProfile value="http://fhir.ch/ig/ch-emed/StructureDefinition/ch-emed-observation"/>
         </type>
      </element>
      <element id="Composition.section:pharmaceuticalAdvice.entry.reference">
         <path value="Composition.section.entry.reference"/>
         <min value="1"/>
      </element>
      <element id="Composition.section:pharmaceuticalAdvice.section">
         <path value="Composition.section.section"/>
         <min value="0"/>
         <max value="0"/>
      </element>

      <!-- Section Annotation -->
      <element id="Composition.section:annotation">
         <path value="Composition.section"/>
         <sliceName value="annotation"/>
         <short value="Annotation"/>
         <min value="0"/>
         <max value="1"/>
      </element>
      <element id="Composition.section.title:annotation">
         <path value="Composition.section.title"/>
         <short value="'Kommentar' in german or 'Commentaire' in french or 'Osservazione' in italian or 'Comment' in english
                        or titles in other languages are also allowed"/>
         <min value="1"/>
         <max value="1"/>
      </element>
      <element id="Composition.section.code:annotation">
         <path value="Composition.section.code"/>
         <min value="1"/>
         <patternCodeableConcept>
            <coding>
               <system value="http://loinc.org"/>
               <code value="48767-8"/>
               <display value="Annotation comment"/>
            </coding>
         </patternCodeableConcept>
      </element>
      <element id="Composition.section.text:annotation">
         <path value="Composition.section.text"/>
         <short value="Human readable text of this section"/>
         <min value="1"/>
         <max value="1"/>
      </element>
   </differential>
</StructureDefinition>